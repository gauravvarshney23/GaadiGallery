<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css" />
<style> 
	#map-page, #map-canvas{ width: 100%; height: 100%; padding: 0; }
</style>
<script src="js/jquery-1.11.3.min.js"></script>
<script>
    $(document).bind('mobileinit',function(){
        $.mobile.changePage.defaults.changeHash = false;
        $.mobile.hashListeningEnabled = false;
        $.mobile.pushStateEnabled = false;
		$.mobile.allowCrossDomainPages = true;
    });
</script>
<script src="js/jquery.mobile-1.4.5.min.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script>
var listCat = {name : null, result : null};
$(document).on('pagebeforeshow', '#firstPage', function(e, data){
    $.ajax({url: "http://gaadigallery.com/api/webservices/categories/",
        dataType: "jsonp",
        async: true,
        success: function (result) {
			listCat.result = JSON.parse(result);
			$.mobile.changePage("#map-page", { transition: "slide", changeHash: false});
			//ajax.parseJSONP(result);
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
        }
    });
});

$(document).on('pagecreate', '#map-page', function() {
	var defaultLatLng = new google.maps.LatLng(12.966667, 77.566667);  // Default to Banglore City in India
    if ( navigator.geolocation ) {
        function success(pos) {
            // Location found, show map with these coordinates
			drawMap(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude));
        }
        function fail(error) {
            drawMap(defaultLatLng);  // Failed to find location, show default map
			//console.log("I m in map error");
        }
        // Find the users current position.  Cache the location for 5 minutes, timeout after 6 seconds
        navigator.geolocation.getCurrentPosition(success, fail, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
    } else {
        drawMap(defaultLatLng);  // No geolocation support, show default map
    }
    function drawMap(latlng) {
        var myOptions = {
            zoom: 14,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
		var map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
        // Add an overlay to the map of current lat/lng
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            title: "Greetings!"
        });
    }
});

$(document).on('pagebeforeshow', '#AboutUs', function(e, data){ 
    $.ajax({url: "http://gaadigallery.com/api/webservices/aboutus/",
        dataType: "jsonp",
        async: true,
        success: function (result) {
			$('#about').empty();
			$('#AboutLoader').fadeOut(0, function(){
				$('#about').append(result);
			});
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
        }
    });
});

$(document).on('pagebeforeshow', '#ContactUs', function(e, data){ 
	$.ajax({url: "http://gaadigallery.com/api/webservices/contactus/",
        dataType: "jsonp",
        async: true,
        success: function (result) {
			$('#contact').empty();
			$('#ContactLoader').fadeOut(0, function(){
				$('#contact').append(result);
			});
        },
        error: function (request,error) {
            alert('Network error has occurred please try again!');
        }
    });
});


$(document).on('pagebeforeshow', '#list-category', function(e, data){		
	$('#list-categories').empty();
	$.each(listCat.result, function(i, row) {
		if(row.count > 0) {
			$('#list-categories').append('<li><a href="" data-id="'+ row.name +'"><img src="' + row.icon + '"/><h2>' + row.name + '</h2><p>' + row.description+ '</p></a></li>');
		}
	});		
	$('#loader').fadeOut(0, function(){
		$('#list-categories').listview('refresh');
	});
});


$(document).on('vclick', '#list-categories li a', function(){  
    listCat.name = $(this).attr('data-id');
    $.mobile.changePage("#category-shop", { transition: "slide", changeHash: false});
});

$(document).on('pagebeforeshow', '#category-shop', function(){      
    $('#shopsList').empty();
	$('#Cate').empty();
    $.each(listCat.result, function(i, row) {
		
		var elem = document.createElement('textarea');
		elem.innerHTML = row.name;
		var decoded1 = elem.value;
		elem.innerHTML = listCat.name;
		var decoded2 = elem.value;
		
        if(decoded1 == decoded2) {
			$('#Cate').append('<h3 style="color: #29b0e2">CATEGORY: ' +row.name+'</h3>');
			$.each(row.shops, function(j, shoprow) {
				//console.log(shoprow);
				try{ 
					$('#shopsList').append('<li><a href="" data-id="'+ shoprow.id +'"><img src="' + shoprow.featured_image + '"/><h2>' + shoprow.title + '</h2><p>' + shoprow.additional_information.map.address + '</p></a></li>');
				}catch(e){}
			});
			$('#shopsList').listview('refresh');
        }
    });
});
</script>
</head>
<body>
<div data-role="page" id="firstPage" style="background-color:white;" data-url="firstPage">
    <div role="main" class="ui-content" id="firstPageBody">
		<img src="GaadiGallery.png" id="logo" style="margin:20px auto;display:block;"></img><br>
		<div style="text-align:center; color: #29b0e2; margin:0px auto;display:block;"><h3>We are moving towards one solution...</h3></div>
		<img src="img/Preloader.gif" id="loader0" style="margin:0px auto;display:block;"></img>
    </div>
</div>	
<div data-role="page" id="map-page" data-url="map-page" style="overflow-y:hidden;">
	<div data-role="panel" id="myPanel1" style="color: #29b0e2" data-display="overlay"> 
		<h2>DISCOVER BANGALORE CITY</h2>
		<ul data-role="listview">
			<li style="color: #29b0e2">Home</li>
			<li><a href="#ContactUs">Contact Us</a></li>
			<li><a href="#AboutUs">About Us</a></li>
			<li><a href="#list-category">Category</a></li>
			<li><a href="#">App Map</a></li>
		</ul>
	</div>
    <div data-role="header" style="background-color: #29b0e2" data-theme="b" data-position="fixed">
		<a href="#myPanel1" class="ui-btn ui-btn-inline ui-corner-all ui-icon-bars ui-btn-icon-notext" data-transition="slide">Home</a>
		<b><label style="text-align:center; font-size: 1.5em;">GAADI GALLERY</label></b>
    </div>
    <div role="main" class="ui-content" id="map-canvas">
		<!-- map loads here... -->
    </div>
	<div class="ui-grid-solo">
	<div class="ui-block-a" style="position: fixed; height: 160px; top: 30%; padding: 5px; border: 3px solid #29b0e2; background-color: rgba(0,0,0,0.1)">
		<b><label for="search" style="text-align:center; font-size: 1.3em; color: #29b0e2;">DISCOVER BANGALORE CITY</label></b>
		<form method="post" action="#">
		<div class="ui-block-a" style="width:65%;"><input type="search" name="search" id="search" value="" placeholder="Search..."></div>
		<div class="ui-block-b" style="width:35%;"><input type="submit" data-inline="false" value="Search"></div>
		</form>
		<div>
			<a href="#list-category" id="category" class="ui-btn ui-btn-b ui-icon-grid ui-btn-icon-left" data-transition="slide" style="color: #29b0e2;">Show Category</a>
		</div>
	</div>
	</div>
</div>

<div style="background-color:white;" data-role="page" id="list-category" data-url="list-category">
	<div data-role="panel" id="myPanel2" style="color: #29b0e2" data-display="overlay"> 
		<h2>DISCOVER BANGALORE CITY</h2>
		<ul data-role="listview">
			<li><a href="#map-page">Home</a></li>
			<li><a href="#ContactUs">Contact Us</a></li>
			<li><a href="#AboutUs">About Us</a></li>
			<li style="color: #29b0e2">Category</li>
			<li><a href="#">App Map</a></li>
		</ul>
	</div>
    <div data-role="header" style="background-color: #29b0e2" data-theme="b" data-position="fixed">
		<a href="#myPanel2" class="ui-btn ui-btn-inline ui-corner-all ui-icon-bars ui-btn-icon-notext" data-transition="slide">Home</a>
		<b><label style="text-align:center; font-size: 1.5em;">GAADI GALLERY</label></b>
		<a href="#map-page" class="ui-btn ui-btn-inline ui-corner-all ui-icon-back ui-btn-icon-notext" data-transition="slide" data-direction="reverse">Back</a>
    </div>
    <div role="main" style="background-color:white;" class="ui-content" id="list-shop">
		<form class="ui-filterable">
			<input id="myFilter" data-type="search" placeholder="Search a Category...">
		</form>
		<img src="img/Preloader.gif" id="loader" style="margin:20px auto;display:block;"></img>
		<ul data-role="listview" id="list-categories" data-filter="true" data-input="#myFilter" data-inset="true">
		  
		</ul>
    </div>
	
</div>

<div data-role="page" style="background-color:white;" id="category-shop" data-url="category-shop">
	<div data-role="panel" id="myPanel3" style="color: #29b0e2" data-display="overlay"> 
		<h2>DISCOVER BANGALORE CITY</h2>
		<ul data-role="listview">
			<li><a href="#map-page">Home</a></li>
			<li><a href="#">Contact Us</a></li>
			<li><a href="#">About Us</a></li>
			<li style="color: #29b0e2">Category</li>
			<li><a href="#">App Map</a></li>
		</ul>
	</div>
    <div data-role="header" style="background-color: #29b0e2" data-theme="b" data-position="fixed">
		<a href="#myPanel3" class="ui-btn ui-btn-inline ui-corner-all ui-icon-bars ui-btn-icon-notext" data-transition="slide">Home</a>
		<b><label style="text-align:center; font-size: 1.5em;">GAADI GALLERY</label></b>
		<a href="#list-category" class="ui-btn ui-btn-inline ui-corner-all ui-icon-back ui-btn-icon-notext" data-transition="slide" data-direction="reverse">Back</a>
    </div>
    <div role="main" style="background-color:white;" class="ui-content" id="book-shop">
		<div>
			<a href="#AdvancedFilter" id="af" data-rel="popup" class="ui-btn ui-icon-bullets ui-btn-icon-left" data-position-to="#af">Advanced filter</a>
		</div>
		<div data-role="popup" id="AdvancedFilter" class="ui-content" style="min-width:250px;" data-arrow="t">
			<a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
		  <form method="post" action="#">
			<div>
			  <h3>Advanced Filter</h3>
			    <fieldset class="ui-field-contain">
				  <label for="location">Select Location</label>
				  <select name="location" id="location" data-mini="true">
					<option value="Location1">Location1</option>
					<option value="Location2">Location2</option>
					<option value="Location3">Location3</option>
					<option value="Location4">Location4</option>
					<option value="Location5">Location5</option>
					<option value="Location6">Location6</option>
					<option value="Location7">Location7</option>
					<option value="Location8">Location8</option>
					<option value="Location9">Location9</option>
					<option value="Location10">Location10</option>
					<option value="Location11">Location11</option>
					<option value="Location12">Location12</option>
					<option value="Location13">Location13</option>
					<option value="Location14">Location14</option>
				  </select>
				</fieldset>
				<label for="points">Radius:</label>
				<input type="range" name="points" id="points" value="30" min="0" max="100" data-highlight="true" data-show-value="true">
				<input type="submit" data-inline="true" value="Search">
			</div>
		  </form>
		</div>
		<form class="ui-filterable">
			<input id="myFilter1" data-type="search" placeholder="Location...">
		</form>
		<p id="Cate"></p>
		<ul data-role="listview" id="shopsList" data-filter="true" data-input="#myFilter1" data-inset="true">
		  
		</ul>
    </div>
</div>

<div data-role="page" style="background-color:white;" id="AboutUs" data-url="AboutUs">
	<div data-role="panel" id="myPanel2" style="color: #29b0e2" data-display="overlay"> 
		<h2>DISCOVER BANGALORE CITY</h2>
		<ul data-role="listview">
			<li><a href="#map-page">Home</a></li>
			<li><a href="#ContactUs">Contact Us</a></li>
			<li style="color: #29b0e2">About Us</li>
			<li><a href="#list-category">Category</a></li>
			<li><a href="#">App Map</a></li>
		</ul>
	</div>
    <div data-role="header" style="background-color: #29b0e2" data-theme="b" data-position="fixed">
		<a href="#myPanel2" class="ui-btn ui-btn-inline ui-corner-all ui-icon-bars ui-btn-icon-notext" data-transition="slide">Home</a>
		<b><label style="text-align:center; font-size: 1.5em;">GAADI GALLERY</label></b>
		<a href="#map-page" class="ui-btn ui-btn-inline ui-corner-all ui-icon-back ui-btn-icon-notext" data-transition="slide" data-direction="reverse">Back</a>
    </div>
    <div role="main" class="ui-content" id="list-shop">
		<img src="img/Preloader.gif" id="AboutLoader" style="margin:20px auto;display:block;"></img>
		<h3 id="about"></h3>
    </div>
	
</div>

<div data-role="page" style="background-color:white;" id="ContactUs" data-url="ContactUs">
	<div data-role="panel" id="myPanel2" style="color: #29b0e2" data-display="overlay"> 
		<h2>DISCOVER BANGALORE CITY</h2>
		<ul data-role="listview">
			<li><a href="#map-page">Home</a></li>
			<li style="color: #29b0e2">Contact Us</li>
			<li><a href="#AboutUs">About Us</a></li>
			<li><a href="#list-category">Category</a></li>
			<li><a href="#">App Map</a></li>
		</ul>
	</div>
    <div data-role="header" style="background-color: #29b0e2" data-theme="b" data-position="fixed">
		<a href="#myPanel2" class="ui-btn ui-btn-inline ui-corner-all ui-icon-bars ui-btn-icon-notext" data-transition="slide">Home</a>
		<b><label style="text-align:center; font-size: 1.5em;">GAADI GALLERY</label></b>
		<a href="#map-page" class="ui-btn ui-btn-inline ui-corner-all ui-icon-back ui-btn-icon-notext" data-transition="slide" data-direction="reverse">Back</a>
    </div>
    <div role="main" class="ui-content" id="list-shop">
		<img src="img/Preloader.gif" id="ContactLoader" style="margin:20px auto;display:block;"></img>
		<h3 id="contact"></h3>
    </div>
	
</div>

</body>
</html>
